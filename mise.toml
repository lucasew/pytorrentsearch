[tools]
uv = "0.9.11"
trunk = "1.3.4"

[tasks.lint]
description = "Run trunk check"
run = "trunk check"

[tasks.fmt]
description = "Run trunk fmt"
run = "trunk fmt"

[tasks.test]
description = "Run tests"
depends = ["test:*"]

[tasks."test:pytest"]
description = "Run pytest"
run = "uv run pytest -v --cov=pytorrentsearch tests/"

[tasks.codegen]
description = "Run code generation"
depends = ["codegen:*"]

[tasks."codegen:none"]
description = "No code generation"
run = "echo 'No codegen'"

[tasks.install]
description = "Install dependencies"
depends = ["install:*"]

[tasks."install:uv"]
description = "Install dependencies with uv"
run = "uv sync"

[tasks.ci]
description = "Run CI tasks"
depends = ["lint", "test"]

[tasks.build]
description = "Build the package"
run = "uv build"

[tasks.clean]
description = "Clean build artifacts and caches"
run = """
find . -type f -name '*.pyc' -delete && \
find . -type d -name '__pycache__' -exec rm -rf {} + 2>/dev/null || true && \
find . -type d -name '.pytest_cache' -exec rm -rf {} + 2>/dev/null || true && \
find . -type d -name '.mypy_cache' -exec rm -rf {} + 2>/dev/null || true && \
find . -type d -name '*.egg-info' -exec rm -rf {} + 2>/dev/null || true && \
rm -rf build dist htmlcov .coverage coverage.xml
"""
